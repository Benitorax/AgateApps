language: php

php:
    - 5.6
    - 7.0

env:
    - 'PHPUNIT_PARAMETERS=" --log-junit shippable/testresults/junit.xml --coverage-xml shippable/codecoverage "'

build:
    cache: true

    cache_dir_list:
        - '$HOME/.phpenv/versions/$(phpenv version-name)/lib/php/extensions/'
        - '$SHIPPABLE_BUILD_DIR/node_modules'
    ci:
        - 'pickle install intl && echo "extension=intl.so" >> $HOME/.phpenv/versions/$(phpenv version-name)/etc/php.ini;'
        - 'mkdir -p shippable/testresults'
        - 'mkdir -p shippable/codecoverage'
        - './tests/ci/ci.bash || if [[ $? == 1 ]]; then exit 0; else exit $? ; fi'
